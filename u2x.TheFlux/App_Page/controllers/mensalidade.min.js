app.controller("mensalidadeCtrl",function(n,t,i,r,u){function e(){n.aluno=u.getAluno()}function f(){U2X_AbreLoader();n.aluno=u.getAluno();i({method:"POST",url:u.url+"/api/Mensalidade_Obtem",data:n.aluno}).then(function(t){n.mensalidades=t.data;U2X_FechaLoader()},function(n){console.log(n);Materialize.toast("Não foi possível realizar a operação",4e3);U2X_FechaLoader()})}n.loggedUsuario=u.getUsuario();n.plano={};n.mensalidade={};U2X_ConfiguraInterface();U2X_AbreLoader();e();f();n.OpenPagamento=function(t){n.mensalidade=t;$("#mdlPagamento").modal("open")};n.ClosePagamento=function(){n.mensalidade={};$("#mdlPagamento").modal("close")};n.RealizaPagamento=function(){U2X_AbreLoader();i({method:"POST",url:u.url+"/api/Mensalidade_Pagar",data:n.mensalidade}).then(function(){U2X_FechaLoader();f();Materialize.toast("Mensalidade paga e comprovante enviado com sucesso",4e3);$("#mdlPagamento").modal("close")},function(n){console.log(n);Materialize.toast("Não foi possível realizar a operação",4e3);U2X_FechaLoader();$("#mdlPagamento").modal("close")});$("#mdlPagamento").modal("close")};n.OpenAddMensalidade=function(){n.plano.parcelas=1;n.plano.valor=0;n.plano.data=new Date;$("#mdlChangePassword").modal("open")};n.CloseAddMensalidade=function(){$("#mdlChangePassword").modal("close")};n.btnAdicionarMensalidade=function(){if(n.plano.parcelas<1){Materialize.toast("Adicionar ao menos uma [parcela]..",4e3);return}if(n.plano.valor<1){Materialize.toast("A [parcela] deve ter mais de um real.",4e3);return}if(!n.plano.data||n.plano.data==""){Materialize.toast("Digite o [Data].",4e3);return}n.plano.valor=n.plano.valor.split(".").join("");U2X_AbreLoader();n.plano.id_aluno=u.getAluno().id;i({method:"POST",url:u.url+"/api/Plano_Adicionar",data:n.plano}).then(function(){U2X_FechaLoader();f();$("#mdlChangePassword").modal("close")},function(n){console.log(n);Materialize.toast("Não foi possível realizar a operação",4e3);U2X_FechaLoader();$("#mdlChangePassword").modal("close")})};n.CloseDeletar=function(){$("#mdlDeletar").modal("close")};n.targetDeleteMensalidade;n.OpenDeletar=function(t){n.targetDeleteMensalidade=t;$("#mdlDeletar").modal("open")};n.DeleteMensalidade=function(){i({method:"POST",url:u.url+"/api/Mensalidade_Remove",data:n.targetDeleteMensalidade}).then(function(){U2X_FechaLoader();f();Materialize.toast("Mensalidade deletada com sucesso",4e3)},function(n){console.log(n);Materialize.toast("Não foi possível realizar a operação",4e3);U2X_FechaLoader();$("#mdlChangePassword").modal("close")})};n.trataValores=U2X_TrataValores;n.getStyle=function(n){return n>0?"green":"red"};n.getStatus=function(n){if(n.status)return n.status;if(n.dt_pagamento)return"Pago";var t=new Date,i=t.getFullYear(),r=t.getMonth()+1;return n.ano<i||n.ano==i&&n.mes<r?"Atrasado":"Aguardando"};n.getFormaPagamento=function(n){return n.formaPagamento?n.formaPagamento:n.dt_pagamento?"Pagamento Manual":""};n.getStyle=function(n){if(n.dt_pagamento)return"grey";var t=new Date,i=t.getFullYear(),r=t.getMonth()+1;return n.ano<i||n.ano==i&&n.mes<r?"red":"black"};n.dataFormat=function(n){return moment(n).format("DD/MM/YYYY")}});