app.controller("addMovimentacaoCtrl",function(n,t,i,r,u){function f(){U2X_AbreLoader();var n=e(),t=o();Promise.all([n,t]).then(function(){U2X_FechaLoader();Materialize.updateTextFields()})}function e(){return new Promise(function(t,r){i({method:"GET",url:u.url+"/api/TipoMovimentacao/"+n.loggedUsuario.id_instituicao}).then(function(i){var r=i.data;r&&r.length>0&&(n.lstTipoMovimentacao=r.filter(function(n){return!n.is_canceled}));t()},function(n){console.log(n);Materialize.toast("Não foi possível realizar a operação",4e3);r()})})}function o(){return new Promise(function(t,r){var f={};f.id_instituicao=n.loggedUsuario.id_instituicao;i({method:"POST",url:u.url+"/api/TipoPagamento_Obtem",data:f}).then(function(i){var r=i.data;r&&r.length>0&&(n.lstTipoPagamento=r.filter(function(n){return n.is_ativo}));t()},function(n){console.log(n);Materialize.toast("Não foi possível realizar a operação",4e3);r()})})}function s(){oUsuario=u.getUsuario();oUsuario||(r.path("/login"),U2X_FechaLoader())}n.lstTipoMovimentacao;n.lstTipoPagamento;n.loggedUsuario=u.getUsuario();n.movimentacao={};n.movimentacao.tipoMovimentacao={};n.movimentacao.tipoPagamento={};n.movimentacao.repetir=1;n.movimentacao.data=moment();n.movimentacao.valor=0;U2X_ConfiguraInterface();s();f();n.btnAdd=function(){if(!n.movimentacao.tipoMovimentacao.id||n.movimentacao.tipoMovimentacao.id==0){Materialize.toast("Selecione o [Tipo de Movimentação].",4e3);return}if(!n.movimentacao.tipoPagamento.id||n.movimentacao.tipoPagamento.id==0){Materialize.toast("Selecione o [Tipo de Pagamento].",4e3);return}if(n.movimentacao.valor<=0){Materialize.toast("Valor deve ser maior que zero.",4e3);return}if(n.movimentacao.repetir<=0){Materialize.toast("A movimentação deve acontecer pelo menos 1 vez.",4e3);return}var t={};t.isEntrada=n.movimentacao.isEntrada;t.idUsuario=n.loggedUsuario.id;t.idTipoMovimentacao=n.movimentacao.tipoMovimentacao.id;t.idTipoPagamento=n.movimentacao.tipoPagamento.id;t.descricao=n.movimentacao.descricao;t.valor=n.movimentacao.valor;t.data=moment(n.movimentacao.data);i({method:"POST",url:u.url+"/api/MovimentacaoPessoal_Adicionar",data:t}).then(function(){r.path("/dashboard");Materialize.toast("Movimentação cadastrada com sucesso.",4e3)},function(n){console.log(n);Materialize.toast("Não foi possível realizar a operação",4e3)})}});